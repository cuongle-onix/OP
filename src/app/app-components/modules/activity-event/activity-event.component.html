<toolbar [data]="toolbar"></toolbar>

<div class="container-fluid main-content">
	<pane-set>
		<pane title="Filter & search" bgColor="#f8f8f8">
			<ng-template pane-content>
				<section class="filter">
					<h5>Filter &amp; Search</h5>
					<filter [data]="storedFilters" placeholder="Stored Filter"></filter>
					<filter [data]="personnelFilters" placeholder="Personnel Filter"></filter>
					<filter [data]="[]" placeholder="View"></filter>
					<div class="d-flex justify-content-center">
						<button class="btn btn-primary btn-search" (click)="onSearch()">Search</button>	
						<button class="btn btn-clear" (click)="clearSearch(clearType.all, $event)">Clear all</button>
					</div>
				</section>
				<section class="search">
					<ngb-accordion class="search-filter-pane" activeIds="ngb-panel-3" [destroyOnHide]="false" [closeOthers]="true">
						<ngb-panel>
							<ng-template ngbPanelTitle>
								<i class="fa fa-caret-right"></i>
								Folders
								<span class="badge" *ngIf="folderCount">{{ folderCount }}</span>
							</ng-template>
							<ng-template ngbPanelContent>
								<custom-treeview [items]="allFolders" (updateCount)="updateCount('folderCount', $event)"></custom-treeview>
							</ng-template>
						</ngb-panel>
						<ngb-panel>
							<ng-template ngbPanelTitle>
								<i class="fa fa-caret-right"></i>
								Departments
								<span class="badge" *ngIf="departmentCount">{{ departmentCount }}</span>
							</ng-template>
							<ng-template ngbPanelContent>
								<custom-treeview [items]="allDepartments" (updateCount)="updateCount('departmentCount', $event)"></custom-treeview>
							</ng-template>
						</ngb-panel>
						<ngb-panel>
							<ng-template ngbPanelTitle>
								<i class="fa fa-caret-right"></i>
								Scopes
								<span class="badge" *ngIf="scopeCount">{{ scopeCount }}</span>
							</ng-template>
							<ng-template ngbPanelContent>
								<custom-treeview [items]="allScopes" (updateCount)="updateCount('scopeCount', $event)"></custom-treeview>
							</ng-template>
						</ngb-panel>
						<ngb-panel>
							<ng-template ngbPanelTitle>
								<i class="fa fa-caret-right"></i>
								Search 
								<span class="badge" *ngIf="searchCount">{{ searchCount }}</span>
								<button class="btn btn-clear" (click)="clearSearch(clearType.search, $event)"></button>
							</ng-template>
							<ng-template ngbPanelContent>
								<search (updateCount)="updateCount('searchCount', $event)"></search>
							</ng-template>
						</ngb-panel>
						<ngb-panel>
							<ng-template ngbPanelTitle>
								<i class="fa fa-caret-right"></i>
								Advanced search
								<span class="badge" *ngIf="advancedSearchCount">{{ advancedSearchCount }}</span>
								<button class="btn btn-clear" (click)="clearSearch(clearType.advanced, $event)"></button>
							</ng-template>
							<ng-template ngbPanelContent>
								<advanced-search (updateCount)="updateCount('advancedSearchCount', $event)"></advanced-search>
							</ng-template>
						</ngb-panel>
					</ngb-accordion>
				</section>
			</ng-template>
		</pane>
		<ng-template details>
			<div class="sub-tabs">
				<ngb-tabset activeId="activity-list" [destroyOnHide]="false">
					<ngb-tab title="Main" id="activity-list">
						<ng-template ngbTabContent>
							<pane-set>
								<pane title="Activities" bgColor="#f99eb4" col="col-3">
									<ng-template pane-content>
										<!-- <div class="group-by">
											Group by:
											<div ngbDropdown class="d-inline-block">
												<button class="btn" ngbDropdownToggle>None</button>
												<div ngbDropdownMenu>
													<button class="dropdown-item">Personel</button>
													<button class="dropdown-item">Status</button>
												</div>
											</div>
										</div>
										<div class="sort-by">
											Sort by:
											<div ngbDropdown class="d-inline-block">
												<button class="btn" ngbDropdownToggle>None</button>
												<div ngbDropdownMenu>
													<button class="dropdown-item">Name</button>
													<button class="dropdown-item">Date</button>
												</div>
											</div>
										</div> -->
										<div class="pr-2">
											<span class="float-right" *ngIf="!checkedItems.length">
												{{ activityList.length }} item(s)
											</span>
											<span class="float-right" *ngIf="checkedItems.length">
												{{ checkedItems.length }} of {{ activityList.length }} selected
											</span>
										</div>
										<list-view
										[items]="activityList" 
										(onSelectItem)="onSelectItem($event)" 
										(onCheckItem)="onCheckItem('checkedItems', $event)"></list-view>
									</ng-template>
								</pane>
								<ng-template details>
									<div class="sub-tabs child-tab">
										<ngb-tabset activeId="details">
											<ng-container *ngIf="selectedActivity && !checkedItems.length">
												<ngb-tab title="Details" id="details">
													<ng-template ngbTabContent>
														<h4 class="pt-4">Activity details</h4>
														<activity-form [id]="selectedActivity.id"></activity-form>
													</ng-template>
												</ngb-tab>
												<ngb-tab title="Connected" id="connected" *ngIf="selectedActivity.connected.length">
													<ng-template ngbTabContent>
														<pane-set>
															<pane title="Connected" bgColor="#B9CCFF" col="col-3">
																<ng-template pane-content>
																	<div class="pr-2">
																		<span class="float-right" *ngIf="!checkedConnectedItems.length">
																			{{ selectedActivity.connected.length }} item(s)
																		</span>
																		<span class="float-right" *ngIf="checkedConnectedItems.length">
																			{{ checkedConnectedItems.length }} of {{ selectedActivity.connected.length }} selected
																		</span>
																	</div>
																	<list-view
																	[items]="selectedActivity.connected"
																	(onSelectItem)="onSelectConnectedItem($event)"
																	(onCheckItem)="onCheckItem('checkedConnectedItems', $event)"></list-view>
																</ng-template>
															</pane>
															<ng-template details>
																<div *ngIf="selectedConnectedItemId && !checkedConnectedItems.length">
																	<h4>Connected details</h4>
																	<activity-form [id]="selectedConnectedItemId"></activity-form>
																</div>
																<div *ngIf="checkedConnectedItems.length">
																	<ul class="list-group options-list">
																		<li class="list-group-item">
																			<button class="btn-change-status">
																				<span></span>Change status
																			</button>
																		</li>
																		<li class="list-group-item">
																			<button class="btn-delete">
																				<span></span>Delete
																			</button>
																		</li>
																		<li class="list-group-item">
																			<button (click)="cancelConnectedChecked()">Cancel</button>
																		</li>
																	</ul>
																</div>
															</ng-template>
														</pane-set>
													</ng-template>
												</ngb-tab>
												<ngb-tab title="Personnel" id="personnel">
													<ng-template ngbTabContent>
														<h4 class="pt-4">General</h4>
														<personnel-form></personnel-form>
													</ng-template>
												</ngb-tab>
											</ng-container>
											<ng-container *ngIf="checkedItems.length">
												<ngb-tab title="Options" id="opt">
													<ng-template ngbTabContent>
														<h4>{{ checkedItems.length }} item(s) selected</h4>
														<ul class="list-group options-list">
															<li class="list-group-item">
																<button class="btn-change-status">
																	<span></span>Change status
																</button>
															</li>
															<li class="list-group-item">
																<button class="btn-delete">
																	<span></span>Delete
																</button>
															</li>
															<li class="list-group-item">
																<button (click)="cancelChecked()">Cancel</button>
															</li>
														</ul>
													</ng-template>
												</ngb-tab>
											</ng-container>
										</ngb-tabset>
									</div>
								</ng-template>				
							</pane-set>
						</ng-template>
					</ngb-tab>
					<ngb-tab title="Graphical" id="graphical">
						<ng-template ngbTabContent>
							Graphical goes here
						</ng-template>
					</ngb-tab>
					<ngb-tab title="Grid view" id="grid-view">
						<ng-template ngbTabContent>
							<table-view [data]="activityList"></table-view>
						</ng-template>
					</ngb-tab>
				</ngb-tabset>				
			</div>
		</ng-template>
	</pane-set>
</div>